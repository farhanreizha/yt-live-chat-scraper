<!DOCTYPE html>
<html>

<head>
    <title>Live Chat Viewer</title>
</head>

<body>
    <h1>Live Chat</h1>
    <ul id="chat"></ul>

    <!-- const videoId = "TheJooomers"; -->
    <!-- const videoId = "1dY3VBuTeuE"; -->
    <script>
        const videoId = "TheJooomers";
        const socket = new WebSocket(`ws://localhost:3000/live/${videoId}`);

        socket.onopen = () => {
            console.log('Connected to server');
        };

        socket.onmessage = (event) => {
            const messages = JSON.parse(event.data);
            const chatList = document.getElementById('chat');

            messages.forEach((msg) => {
                const li = document.createElement('li');
                li.textContent = `${msg.author}: ${msg.message.text}`;
                chatList.appendChild(li);
            });
        };

        socket.onclose = () => {
            console.log('Disconnected');
            const chatList = document.getElementById('chat');
            chatList.innerHTML = '<li>Live ended</li>';
        };
    </script>
</body>

</html>
